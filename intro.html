
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>General framework &#8212; dolfinx_materials</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'intro';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="JAX implementation of material behaviors" href="jax.html" />
    <link rel="prev" title="Documentation" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">dolfinx_materials</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Documentation
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">General framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="jax.html">JAX implementation of material behaviors</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">JAX demos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="jax_elastoplasticity.html">JAX implementation of elastoplasticity</a></li>
<li class="toctree-l1"><a class="reference internal" href="demos/elastoplasticity/Hosford_yield_surface.html">Computing the Hosford plane stress yield surface</a></li>
<li class="toctree-l1"><a class="reference internal" href="demos/elastoplasticity/plane_elastoplasticity.html">Finite-element simulations of JAX elastoplasticity</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MFront demos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="demos/mfront/heat_transfer/nonlinear_heat_transfer.html">Stationary nonlinear heat transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="demos/mfront/heat_transfer/phase_change.html">Transient heat equation with phase change</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CVXPY demos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cvxpy.html">Convex optimization-based constitutive update</a></li>
<li class="toctree-l1"><a class="reference internal" href="demos/cvxpy/cvxpy_return_mapping.html">Computing yield surfaces</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="api/material.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">material</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="api/quadrature_map.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">quadrature_map</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="api/solvers.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">solvers</span></code></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>General framework</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nonlinear-constitutive-equations">Nonlinear constitutive equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#consistent-tangent-operator">Consistent tangent operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-strain-setting">Finite-strain setting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generalized-behaviors">Generalized behaviors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-aspects-and-automatic-differentiation">Computational aspects and Automatic Differentiation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="general-framework">
<h1>General framework<a class="headerlink" href="#general-framework" title="Link to this heading">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">dolfinx_materials</span></code> library aims at providing a general framework for using custom material behaviors within the <code class="docutils literal notranslate"><span class="pre">FEniCSx</span></code> PDE library.
In particular, <code class="docutils literal notranslate"><span class="pre">ufl</span></code> and <code class="docutils literal notranslate"><span class="pre">dolfinx</span></code> limitations make it difficult to formulate complex material behaviors such as viscoelasticity, plasticity, damage or even some complex hyperelastic behaviors.</p>
<p>The library expands upon previous implementations of user-defined constitutive models by providing a more general and extensible setting, targeting advanced implementation of material models including:</p>
<ul class="simple">
<li><p>materials defined by internal state variables and a system of implicit equations</p></li>
<li><p>multi-physics behaviors not limited to mechanics e.g. thermo-hydro-mechanics models</p></li>
<li><p>material behaviors defined by machine-learning or data-driven methods</p></li>
<li><p>multiscale material behaviors</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>We list below a few resources upon which this library has been built:</p>
<ul class="simple">
<li><p>the <a class="reference external" href="https://thelfer.github.io/mgis/web/mgis_fenics.html"><code class="docutils literal notranslate"><span class="pre">mgis.fenics</span></code></a> project, binding <code class="docutils literal notranslate"><span class="pre">MFront</span></code> with legacy <code class="docutils literal notranslate"><span class="pre">FEniCS</span></code></p></li>
<li><p><a class="reference external" href="https://bleyerj.github.io/comet-fenicsx/tours/nonlinear_problems/plasticity/plasticity.html">implementation of elasto-plasticity</a> within <code class="docutils literal notranslate"><span class="pre">FEniCSx</span></code></p></li>
<li><p><a class="reference external" href="https://bleyerj.github.io/comet-fenicsx/tours/nonlinear_problems/linear_viscoelasticity_jax/linear_viscoelasticity_jax.html">JAX implementation of viscoelasticity</a> within <code class="docutils literal notranslate"><span class="pre">FEniCSx</span></code></p></li>
</ul>
</div>
<div class="important admonition">
<p class="admonition-title">Future changes</p>
<p>Integration with the <code class="docutils literal notranslate"><span class="pre">dolfinx</span></code> library will probably be reimplemented in the next future based on the concept of <code class="docutils literal notranslate"><span class="pre">ExternalOperator</span></code>. For more details, see <a class="reference external" href="https://a-latyshev.github.io/dolfinx-external-operator/">External operators within FEniCSx/DOLFINx</a>.</p>
</div>
<section id="nonlinear-constitutive-equations">
<h2>Nonlinear constitutive equations<a class="headerlink" href="#nonlinear-constitutive-equations" title="Link to this heading">#</a></h2>
<p><span class="math notranslate nohighlight">\(\newcommand{\bsig}{\boldsymbol{\sigma}}
\newcommand{\beps}{\boldsymbol{\varepsilon}}
\newcommand{\balpha}{\boldsymbol{\alpha}}
\newcommand{\bepsv}{\boldsymbol{\varepsilon}^\text{v}}
\newcommand{\epsv}{\varepsilon^\text{v}}
\newcommand{\sigv}{\sigma^\text{v}}
\newcommand{\bu}{\boldsymbol{u}}
\newcommand{\bq}{\boldsymbol{q}}
\newcommand{\bv}{\boldsymbol{v}}
\newcommand{\bI}{\boldsymbol{I}}
\newcommand{\bF}{\boldsymbol{F}}
\newcommand{\bP}{\boldsymbol{P}}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\bT}{\boldsymbol{T}}
\newcommand{\dOm}{\,\text{d}\Omega}
\newcommand{\dS}{\,\text{d}S}
\newcommand{\dt}{\,\text{d}t}
\newcommand{\Neumann}{{\partial \Omega_\text{N}}}
\newcommand{\Dirichlet}{{\partial \Omega_\text{D}}}\)</span></p>
<p>In the following, we aim at solving a small-strain solid mechanics problem involving a general nonlinear constitutive behavior. Such a constitutive behavior will be seen as generic black-box function. It expresses the stress <span class="math notranslate nohighlight">\(\bsig\)</span> as a function of the total strain <span class="math notranslate nohighlight">\(\beps\)</span>, yielding the following nonlinear variational problem:</p>
<div class="math notranslate nohighlight" id="equation-nonlinear-variational-model">
<span class="eqno">(1)<a class="headerlink" href="#equation-nonlinear-variational-model" title="Link to this equation">#</a></span>\[\int_{\Omega} \bsig(\beps):\nabla^s \bv \dOm = \int_\Omega \boldsymbol{f}\cdot\bv \dOm + \int_{\partial \Omega_\text{N}} \bT\cdot\bv \dS \quad \forall\bv \in V\]</div>
<p>In practice, the nonlinear function <span class="math notranslate nohighlight">\(\bsig(\beps)\)</span> is parameterized by material parameters and can also depend upon a set of variables which reflects the state and past history of the material. Such <strong>state</strong> consists of so-called <em>internal state variables</em> which may be plastic strains, viscous strains/stresses, damage, porosity, etc. We collect them in the global notation <span class="math notranslate nohighlight">\(\balpha\)</span>.</p>
<p>The mapping <span class="math notranslate nohighlight">\(\bsig(\beps)\)</span> is therefore often implicit and would rather be something like:</p>
<div class="math notranslate nohighlight">
\[\bsig(\beps,\balpha) \quad \text{s.t.}\quad F(\beps,\balpha,\dot{\balpha})=0\]</div>
<p>where <span class="math notranslate nohighlight">\(F(\beps,\balpha,\dot{\balpha})\)</span> defines a system of evolution equations of the internal state variables. Upon performing a time-discretization, we collect in the set <span class="math notranslate nohighlight">\(\mathcal{S}_n\)</span> the state of the material at time <span class="math notranslate nohighlight">\(t_n\)</span>, here we have <span class="math notranslate nohighlight">\(\mathcal{S}_n = \{\balpha_n\}\)</span>. The evaluation of the constitutive equation will be strain-driven in the sense that we provide a total strain increment <span class="math notranslate nohighlight">\(\Delta \beps\)</span> and the previous state at time <span class="math notranslate nohighlight">\(t_n\)</span> and the role of the constitutive model is to compute the new stress <span class="math notranslate nohighlight">\(\bsig_{n+1}\)</span> and the new state <span class="math notranslate nohighlight">\(\mathcal{S}_{n+1} = \{\balpha_{n+1}\}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-constitutive-black-box">
<span class="eqno">(2)<a class="headerlink" href="#equation-constitutive-black-box" title="Link to this equation">#</a></span>\[\beps=\beps_n+\Delta\beps, \mathcal{S}_n \longrightarrow \boxed{\text{CONSTITUTIVE RELATION}}\longrightarrow \bsig_{n+1}, \mathcal{S}_{n+1}\]</div>
<p>where <span class="math notranslate nohighlight">\(\bsig_{n+1},\balpha_{n+1}\)</span> are obtained by solving the following problem:</p>
<div class="math notranslate nohighlight">
\[\bsig_{n+1}=\bsig(\beps_n+\Delta\beps,\balpha_{n+1}) \quad \text{s.t.}\quad F_n(\beps_n+\Delta\beps,\balpha_{n+1})=0\]</div>
<p>given <span class="math notranslate nohighlight">\(\Delta\beps, \beps_n, \balpha_n\)</span> and where <span class="math notranslate nohighlight">\(F_n\)</span> denotes a time-discretized version of <span class="math notranslate nohighlight">\(F\)</span> i.e. depending on <span class="math notranslate nohighlight">\(\balpha_n\)</span> for instance. For more details on the various discretization strategies and solving schemes, we refer to <span id="id1">[<a class="reference internal" href="#id3" title="Juan C Simo and Thomas JR Hughes. Computational inelasticity. Volume 7. Springer Science &amp; Business Media, 2006.">Simo and Hughes, 2006</a>]</span>. In the <code class="docutils literal notranslate"><span class="pre">dolfinx_materials</span></code> library, such an evolution will be managed by a concrete implementation of a <code class="docutils literal notranslate"><span class="pre">Material</span></code> object using, for instance, a third-party library. This constitutive update is therefore fully decoupled from the finite-element library which sees only <span class="math notranslate nohighlight">\(\bsig(\beps)\)</span> as an abstract non-linear function.</p>
</section>
<section id="consistent-tangent-operator">
<h2>Consistent tangent operator<a class="headerlink" href="#consistent-tangent-operator" title="Link to this heading">#</a></h2>
<p>However, when solving the <em>global</em> variational problem <a class="reference internal" href="#equation-nonlinear-variational-model">(1)</a>, we generally use a <em>global</em> Newton-Raphson solver. The jacobian of this nonlinear problem involves the following tangent bilinear form:</p>
<div class="math notranslate nohighlight" id="equation-tangent-bilinear-form">
<span class="eqno">(3)<a class="headerlink" href="#equation-tangent-bilinear-form" title="Link to this equation">#</a></span>\[a_\text{tangent}(\bu,\bv) = \int_{\Omega} \nabla^s \bu: \mathbb{C}_\text{tang}(\beps):\nabla^s \bv \dOm \quad \text{where } \mathbb{C}_\text{tang}(\beps)=\dfrac{\partial \bsig}{\partial \beps}(\beps)\]</div>
<p>which involves the local tangent stiffness tensor <span class="math notranslate nohighlight">\(\mathbb{C}_\text{tang}(\beps)\)</span>. The latter is the direct differentiation of the mapping <a class="reference internal" href="#equation-constitutive-black-box">(2)</a>. The <code class="docutils literal notranslate"><span class="pre">Material</span></code> object must therefore, not only provide a concrete implementation of the stress evaluation but also of its derivative with respect to the imposed strain <span class="math notranslate nohighlight">\(\beps\)</span>. This step is crucial as it directly impacts the convergence quality of the global Newton system, and it is often cumbersome and error-prone.</p>
<p>To streamline this process, Automatic Differentiation (AD) tools, such as those available in JAX, become highly valuable. These tools automate the differentiation process, reducing errors and enhancing the efficiency of computing the tangent operator. We will leverage JAX’s AutoDiff capabilities extensively when working with <code class="docutils literal notranslate"><span class="pre">JAXMaterial</span></code> objects, see <a class="reference internal" href="jax.html"><span class="std std-doc">JAX implementation of material behaviors</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For some generalized multi-physics behaviors, we may also need some derivatives of a state variable in <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> with respect to the imposed strain.</p>
</div>
</section>
<section id="finite-strain-setting">
<h2>Finite-strain setting<a class="headerlink" href="#finite-strain-setting" title="Link to this heading">#</a></h2>
<p>The above presentation which focused on a small strain setting can be directly extended towards the finite strain setting. We rely on a total Lagrangian formulation and write the equilibrium on the reference configuration which we still denote <span class="math notranslate nohighlight">\(\Omega\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-finite-strain-variational-model">
<span class="eqno">(4)<a class="headerlink" href="#equation-finite-strain-variational-model" title="Link to this equation">#</a></span>\[\int_{\Omega} \bP(\bF):\nabla^s \bv \dOm = \int_\Omega \boldsymbol{f}\cdot\bv \dOm + \int_{\partial \Omega_\text{N}} \bT\cdot\bv \dS \quad \forall\bv \in V\]</div>
<p>where we use now the first Piola-Kirchhoff (PK1) stress <span class="math notranslate nohighlight">\(\bP(\bF)\)</span> as an implicit function of the total deformation gradient <span class="math notranslate nohighlight">\(\bF=\bI+\nabla\bu\)</span>. Depending on the chosen material, some constitutive equations are more easily written by changing the stress/strain measure, using for instance the second Piola-Kirchhoff stress and the Green-Lagrange strain. Material libraries such as MFront typically provide some helper functions to convert the different stress/strain measures.</p>
</section>
<section id="generalized-behaviors">
<h2>Generalized behaviors<a class="headerlink" href="#generalized-behaviors" title="Link to this heading">#</a></h2>
<p>The same framework can also be extended to a multiphysics setting involving coupling of the mechanics with other physics such as heat or transport phenomena. To fix ideas, let us consider a thermo-mechanical system characterized by the heat and balance equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\int_{\Omega}\rho T_0 \dot{s}\widehat{T}d\Omega - \int_{\Omega} \boldsymbol{q}\cdot\nabla \widehat{T}d\Omega= 0 \quad \forall \widehat{T} \in V_T\\
\int_{\Omega} \bsig:\nabla^s \bv \dOm = \int_\Omega \boldsymbol{f}\cdot\bv \dOm + \int_{\partial \Omega_\text{N}} \bT\cdot\bv \dS \quad \forall\bv \in V_u
\end{align}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(T_0\)</span> is a reference temperature, <span class="math notranslate nohighlight">\(s\)</span> the entropy per unit of mass and <span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span> the heat flux.</p>
<p>In a fully coupled setting, <span class="math notranslate nohighlight">\(s,\bq\)</span> and <span class="math notranslate nohighlight">\(\bsig\)</span> are typically functions of the temperature <span class="math notranslate nohighlight">\(T\)</span>, the temperature gradient <span class="math notranslate nohighlight">\(\nabla T\)</span> and the strain <span class="math notranslate nohighlight">\(\beps\)</span>. The same abstract constitutive mapping as in <a class="reference internal" href="#equation-constitutive-black-box">(2)</a> can therefore be considered by replacing the input with a set of <em>external state variables</em> (here the temperature <span class="math notranslate nohighlight">\(T\)</span>) and of <em>gradients</em> (here the temperature gradient <span class="math notranslate nohighlight">\(\nabla T\)</span> and the strain <span class="math notranslate nohighlight">\(\beps\)</span>). The output of the constitutive equation is now a set of <em>fluxes</em> (here the heat flux <span class="math notranslate nohighlight">\(\bq\)</span> and the stress <span class="math notranslate nohighlight">\(\bsig\)</span>) and of <em>internal state variables</em> (here the entropy). Again, to formulate a monolithic Newton method of this coupled system, various derivatives of outputs (fluxes + internal state variables) with respect to inputs (gradients and external state variables) should be provided by the material library. Finally, the heat and mechanics equations can also be solved in a staggered manner.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>For more details on such examples, we refer to the following MFront demos:</p>
<ul class="simple">
<li><p><a class="reference internal" href="demos/mfront/heat_transfer/nonlinear_heat_transfer.html"><span class="std std-doc">Nonlinear heat transfer</span></a></p></li>
<li><p><a class="reference internal" href="demos/mfront/heat_transfer/phase_change.html"><span class="std std-doc">Phase change</span></a></p></li>
</ul>
</div>
</section>
<section id="computational-aspects-and-automatic-differentiation">
<h2>Computational aspects and Automatic Differentiation<a class="headerlink" href="#computational-aspects-and-automatic-differentiation" title="Link to this heading">#</a></h2>
<p>The constitutive update process involves solving a small, local system of nonlinear evolution equations at each integration point to update the material state. This process, even for complex models like crystal plasticity with hundreds of state variables, is highly parallelizable and computationally efficient compared to solving the global system of equations governing the entire structure. Since the constitutive update takes up only a small fraction of the total computational time, there is flexibility to use more complex and expressive material models without significantly impacting overall performance. This context presents a promising opportunity for the application of automatic differentiation. AD can streamline the development and implementation of these complex constitutive models by automatically generating the necessary derivatives for the nonlinear equations and the associated consistent tangent operators, improving accuracy and reducing the manual effort required for coding, debugging, and optimizing these models. Consequently, modern AD tools can further enhance the expressiveness and ease of implementation of advanced material models without sacrificing computational efficiency.</p>
<p>However, attention should be paid as how to use AD in the context of constitutive modeling. For instance, performing AD on an unrolled version of the constitutive update program will not be efficient. The JAX section discusses various strategies, including custom differentiation using the implicit theorem to seamlessly perform AD on the constitutive update implementation.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<div class="docutils container" id="id2">
<div role="list" class="citation-list">
<div class="citation" id="id3" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">SH06</a><span class="fn-bracket">]</span></span>
<p>Juan C Simo and Thomas JR Hughes. <em>Computational inelasticity</em>. Volume 7. Springer Science &amp; Business Media, 2006.</p>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Documentation</p>
      </div>
    </a>
    <a class="right-next"
       href="jax.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">JAX implementation of material behaviors</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nonlinear-constitutive-equations">Nonlinear constitutive equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#consistent-tangent-operator">Consistent tangent operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-strain-setting">Finite-strain setting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generalized-behaviors">Generalized behaviors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-aspects-and-automatic-differentiation">Computational aspects and Automatic Differentiation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jeremy Bleyer
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>